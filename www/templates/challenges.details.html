<ion-view title="Details">
  <ion-nav-buttons side="left">
    <button menu-toggle="left" class="button button-icon icon ion-navicon"></button>
  </ion-nav-buttons>
  <ion-content class="has-header main">

    <ul class="list card">
      <div class="item" style="padding: 0px;">
        <!--<img src="mcfly.jpg">-->
        <div class="row">
          <div class="col">
            <img src="{{selectedChallenge.requestingUser.avatar}}" width="50px"/>
          </div>
          <div class="col" style="text-align: center;">
            <h3><strong>versus</strong></h3>
          </div>
          <div class="col" style="text-align: right;">
            <img src="{{selectedChallenge.requestedUser.avatar}}" width="50px"/>
          </div>
        </div>
      </div>

      <div class="item item-body">
        <h4>Kategorie: {{selectedChallenge.sport.name}}</h4>
        <h4>Aufgabe: {{selectedChallenge.exercise.name}}</h4>
        <h4>Wert: {{selectedChallenge.exerciseValue}}</h4>
        <h4>Status: {{selectedChallenge.status}}</h4>
        <h4>Ablaufdatum: {{selectedChallenge.expireDate | date:'dd.MM.yyyy - HH:mm'}} Uhr</h4>

        <div class="row" style="padding: 0px;">
          <div class="col" style="padding: 0px;">
            <img src="data:image/jpeg;base64,{{selectedChallenge.proofImageAsString}}"
                 ng-if="selectedChallenge.proofImageAsString" width="100%"/>
          </div>
        </div>
      </div>

      <div class="item tabs tabs-secondary tabs-icon-left"
           ng-if="selectedChallenge.status != 'DENIED' || selectedChallenge.status != 'TOBEPROOFED'">
        <!-- Aktzeptieren oder Ablehnen -->
        <a class="tab-item" href=""
           ng-if="selectedChallenge.status === 'WAITING' && selectedChallenge.requestedUser.nickname === profile.nickname"
           ng-click="updateStatus('ACCEPTED', 'NONE')">
          <i class="icon ion-checkmark-round"></i>
          Aktzeptieren
        </a>
        <a class="tab-item" href=""
           ng-if="selectedChallenge.status === 'WAITING' && selectedChallenge.requestedUser.nickname === profile.nickname"
           ng-click="updateStatus('DENIED', 'NONE')">
          <i class="icon ion-close-round"></i>
          Ablehnen
        </a>

        <!-- Abschließen oder Aufgeben -->
        <a class="tab-item" href=""
           ng-if="selectedChallenge.status === 'ACCEPTED' && selectedChallenge.requestedUser.nickname === profile.nickname"
           ng-click="getPicture()">
          <i class="icon ion-ribbon-a"></i>
          Abschließen
        </a>
        <a class="tab-item" href=""
           ng-if="selectedChallenge.status === 'ACCEPTED' && selectedChallenge.requestedUser.nickname === profile.nickname"
           ng-click="updateStatus('DENIED', 'REQUESTING')">
          <i class="icon ion-flag"></i>
          Aufgeben
        </a>

        <!-- Bestätigen oder Ablehnen -->
        <a class="tab-item" href=""
           ng-if="selectedChallenge.status === 'TOBEPROOFED' && selectedChallenge.requestingUser.nickname === profile.nickname"
           ng-click="updateStatus('PASSED', 'REQUESTED')">
          <i class="icon ion-checkmark-round"></i>
          Bestätigen
        </a>
        <a class="tab-item" href=""
           ng-if="selectedChallenge.status === 'TOBEPROOFED' && selectedChallenge.requestingUser.nickname === profile.nickname"
           ng-click="updateStatus('DENIED', 'REQUESTING')">
          <i class="icon ion-close-round"></i>
          Ablehnen
        </a>
        <!--<a class="tab-item" href="#">-->
        <!--<i class="icon ion-share"></i>-->
        <!--Share-->
        <!--</a>-->
      </div>
    </ul>

    <h3>Kommentare</h3>

    <div class="list">
      <li class="item" style="padding: 5px;">
        <div class="row">
          <div class="col-25">
            <img src="{{profile.avatar}}" width="45px"/>
          </div>
          <div class="col-50">
            <label class="item item-input">
              <input type="text" placeholder="Schreibe einen Kommentar" ng-model="comment.message">
            </label>
          </div>
          <div class="col-25" style="text-align: right;font-size: 45px;">
            <i class="icon ion-paper-airplane" ng-click="createComment(comment)"></i>
          </div>
        </div>

      </li>
      <li class="item" ng-repeat="comment in selectedChallenge.comments" ng-if="selectedChallenge.comments.length > 0">
        <strong>{{comment.user.nickname}}:</strong> {{comment.message}}
      </li>
    </div>

  </ion-content>
</ion-view>
